<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WB Orders — Поиск заказа</title>
  <style>
    body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; line-height: 1.4; }
    .card { max-width: 900px; margin: 0 auto; padding: 16px 20px; border: 1px solid #e5e7eb; border-radius: 12px; box-shadow: 0 1px 2px rgba(0,0,0,.04); }
    .row { display: flex; gap: 8px; margin-bottom: 12px; }
    input { flex: 1; padding: 10px 12px; font-size: 16px; border: 1px solid #cbd5e1; border-radius: 8px; }
    button { padding: 10px 14px; font-size: 16px; border: 0; border-radius: 8px; cursor: pointer; background: #4f46e5; color: white; }
    button:disabled { opacity: .6; cursor: progress; }
    .muted { color: #6b7280; font-size: 14px; }
    pre { background: #0b1020; color: #d1e7ff; padding: 16px; border-radius: 10px; overflow: auto; font-size: 13px; }
    .error { color: #b91c1c; margin-top: 8px; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Поиск заказа</h2>
    <p class="muted">Введи <code>order_uid</code> и нажми «Найти». Запрос пойдёт на API <code>/order/&lt;id&gt;</code>.</p>

    <div class="row">
      <input id="orderId" placeholder="например: test-123" />
      <button id="findBtn">Найти</button>
    </div>

    <div id="msg" class="error" style="display:none;"></div>
    <pre id="out" style="display:none;"></pre>
  </div>

  <script>
    const $ = sel => document.querySelector(sel);
    const idInput = $('#orderId');
    const btn = $('#findBtn');
    const out = $('#out');
    const msg = $('#msg');

    async function search() {
      const id = idInput.value.trim();
      out.style.display = 'none';
      msg.style.display = 'none';
      if (!id) {
        msg.textContent = 'Введите order_uid';
        msg.style.display = 'block';
        return;
      }
      btn.disabled = true;
      try {
        const res = await fetch(`/order/${encodeURIComponent(id)}`);
        if (!res.ok) {
          const text = await res.text();
          throw new Error(text || `HTTP ${res.status}`);
        }
        const data = await res.json();
        out.textContent = JSON.stringify(data, null, 2);
        out.style.display = 'block';
      } catch (e) {
        msg.textContent = e.message || 'Ошибка запроса';
        msg.style.display = 'block';
      } finally {
        btn.disabled = false;
      }
    }

    btn.addEventListener('click', search);
    idInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') search();
    });

    // удобство: автофокус
    idInput.focus();
  </script>
</body>
</html>
